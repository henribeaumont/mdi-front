/* ==========================================================
   MDI QUIZ / SONDAGE — DESIGN FINAL
   ========================================================== */
html, body { width: 100%; height: 100%; margin: 0; background: transparent; overflow: hidden; }

#quiz-container, #security-screen { display: none; }
html.mdi-ready #quiz-container { display: grid; }
html.mdi-denied #security-screen { display: flex; }

.quiz-root {
  position: fixed; inset: 0; display: grid;
  justify-items: center; align-content: center;
  row-gap: var(--panel-gap, 18px);
  pointer-events: none;
  font-family: var(--font-family, "Montserrat", sans-serif);
}

/* Sécurité */
#security-screen {
  position: fixed; inset: 0; background: transparent;
  justify-content: center; align-items: center; flex-direction: column;
  text-align: center; font-weight: 600;
}
.security-x { font-size: 120px; color: #ff3b30; }
.security-text { font-size: 54px; color: #ff3b30; }

/* Panels */
.panel {
  width: min(92vw, 1680px); border-radius: 48px; padding: 44px;
  background: #585858; box-shadow: 0 40px 80px rgba(0,0,0,0.35);
  transition: opacity 280ms ease, transform 280ms ease;
}
.panel-question { opacity: 0; transform: translateY(-10px); }
.panel-answers { opacity: 0; transform: translateY(10px); position: relative; }

html[data-mdi-state="prompt"] .panel-question,
html[data-mdi-state="open"] .panel-question,
html[data-mdi-state="results"] .panel-question,
html[data-mdi-state="reveal"] .panel-question,
html[data-mdi-state="winner"] .panel-question { opacity: 1; transform: translateY(0); }

html[data-mdi-state="open"] .panel-answers,
html[data-mdi-state="results"] .panel-answers,
html[data-mdi-state="reveal"] .panel-answers,
html[data-mdi-state="winner"] .panel-answers { opacity: 1; transform: translateY(0); }

/* Question */
.question {
  min-height: 160px; border-radius: 34px;
  display: grid; place-items: center; text-align: center;
  font-weight: 800; font-size: 82px; color: #fff; padding: 20px 40px;
  background: linear-gradient(180deg, #0A0F1E, #3A3F75);
  border: 5px solid rgba(90, 95, 255, 0.95);
  box-shadow: 0 18px 30px rgba(0,0,0,0.35);
}

/* Réponses */
.answers { display: grid; grid-template-columns: 1fr 1fr; gap: 26px; }

.answer {
  height: 150px; border-radius: 999px;
  display: grid; grid-template-columns: 108px 1fr auto; align-items: center;
  padding: 0 30px 0 18px; column-gap: 18px;
  background: #203B56; 
  border: 3px solid rgba(80, 220, 255, 0.2);
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  opacity: 1; transform: translateY(0);
  transition: all 0.5s ease; /* Transition douce pour l'estompage */
  position: relative; overflow: hidden; z-index: 1;
}

/* Jauge de fond */
.answer::before {
  content: ""; position: absolute; inset: 0; z-index: -1;
  background: var(--gauge-bg, transparent);
  width: var(--gauge-width, 0%);
  transition: width 1s ease-out;
}

.badge {
  width: 94px; height: 94px; border-radius: 999px;
  display: grid; place-items: center;
  font-weight: 900; font-size: 40px; color: #0a0f1e; background: #fff;
}
.answer-text {
  font-weight: 800; font-size: 74px; color: #fff;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.pct {
  font-weight: 900; font-size: 74px; color: #fff;
  opacity: 0; transform: translateY(4px); transition: opacity 180ms;
}
html.mdi-show-results .pct { opacity: 1; }

/* Options cachées */
html.mdi-options-hidden .answer { opacity: 0; transform: translateY(10px); }

/* --- DESIGN QUIZ & POLL --- */

/* 1. QUIZ : Bonne réponse */
.answer.is-correct {
  border-color: #2ECC71;
  box-shadow: 0 0 40px rgba(46, 204, 113, 0.8), inset 0 0 20px rgba(46, 204, 113, 0.4);
  background: linear-gradient(90deg, rgba(46,204,113,0.3), rgba(46,204,113,0.1));
}
.answer.is-correct .badge { background: #2ECC71; color: #fff; }

/* 2. SONDAGE : Jauges */
.answer[data-rank="1"] { --gauge-bg: linear-gradient(90deg, rgba(46,204,113,0.8), rgba(46,204,113,0.4)); }
.answer[data-rank="2"] { --gauge-bg: linear-gradient(90deg, rgba(241,196,15,0.8), rgba(241,196,15,0.4)); }
.answer[data-rank="3"] { --gauge-bg: linear-gradient(90deg, rgba(230,126,34,0.8), rgba(230,126,34,0.4)); }
.answer[data-rank="4"] { --gauge-bg: linear-gradient(90deg, rgba(231,76,60,0.8), rgba(231,76,60,0.4)); }

/* --- ETAT WINNER (Amélioré) --- */

/* L'élément Winner passe par dessus tout */
.winner {
  position: absolute; inset: 0; 
  display: flex; justify-content: center; align-items: center; gap: 20px;
  font-weight: 900; font-size: 140px; color: #fff;
  opacity: 0; pointer-events: none; z-index: 50; /* Z-index très haut */
  
  /* Grosse ombre portée noire pour lisibilité max */
  text-shadow: 
    0 10px 40px rgba(0,0,0,0.8),
    0 0 0px #000, 
    0 0 20px rgba(0,0,0,0.5);
    
  transform: scale(0.9);
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

html.mdi-show-winner #winner { 
  opacity: 1; 
  transform: scale(1);
}

/* On éteint les réponses quand le gagnant est là */
html.mdi-dim-answers .answer {
  opacity: 0.05 !important; /* Quasi invisible */
  filter: blur(4px);        /* Flou d'arrière plan */
}

/* (Optionnel) Si tu veux quand même voir la bonne réponse en fond, décommente ça : */
/* html.mdi-dim-answers .answer.force-visible { opacity: 0.3 !important; filter: blur(2px); } */
